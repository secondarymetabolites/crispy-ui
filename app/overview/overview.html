<div ng-controller="OverviewController as overview">
<div class="container organism-info">
  <div class="well well-lg">
    <div ng-show="overview.session.state == 'pending'">
      {{overview.session.state}}: <img src="/images/loading.gif" /><br>
      Last updated: {{overview.session.last_updated}}
    </div>
    <div ng-show="overview.session.state == 'loaded'">
      <em>{{overview.session.genome.organism}}</em> ({{overview.session.genome.id}})<br>
      {{overview.session.genome.description}}<br>
      Sequence length: {{overview.session.genome.length}}<br>
      {{overview.session.genome.orfs.length}} genes<br>
      Loaded at: {{overview.session.last_updated}}
    </div>
    <div ng-show="overview.session.state == 'error'">Error: {{overview.session.error}}</div>
  </div>
</div>

<div class="container" ng-show="overview.session.state == 'loaded'">
  <form class="form-horizontal" name="targetForm" novalidate>
    <div class="form-group" ng-class="{'has-error': overview.error}">
      <label for="target" class="control-label col-sm-2">Select target</label>
      <div class="input-group col-sm-8">
        <span class="input-group-btn">
          <button class="btn btn-default" type="button" popover="{{targetTooltip}}" popover-placement="left"
                  popover-append-to-body>
            <i class="fa fa-info"></i>&nbsp;
          </button>
        </span>
        <input type="text" class="form-control" id="target" placeholder="Range, locus tag or cluster number" ng-model="overview.target"
               typeahead="name for name in overview.typeahead | filter:$viewValue | limitTo:8" required>
        <span class="input-group-btn">
          <button class="btn btn-primary" ng-disabled="targetForm.$invalid" ng-click="overview.submit()">
            <i class="fa fa-search"></i> Find targets
          </button>
        </span>
      </div>
      <span class="help-block" ng-show="overview.error">{{overview.error}}</span>
    </div>
    <div class="form-group">
    </div>
  </form>
</div>

<div class="container clusters-table" ng-show="overview.session.state == 'loaded'">
  <table class="table table-striped table-hover">
    <thead>
    <tr>
      <th class="text-right">From</th>
      <th class="text-right">To</th>
      <th>Cluster #</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="cluster in overview.session.genome.clusters" ng-click="overview.selectTarget(cluster.name)">
      <td class="text-right">{{cluster.start}}</td>
      <td class="text-right">{{cluster.end}}</td>
      <td>{{cluster.name}}</td>
      <td>{{cluster.type}}</td>
      <td>{{cluster.description}}</td>
    </tr>
    </tbody>
  </table>
</div>
</div>
